/* crc32.c - crc (cyclic redundancy check) implementations */

#include <libf/config.h>
#include <libf/sl/xstddef.h>
#include <libf/sl/xstdint.h>
#include <libf/al/crc32.h>


/* @def: crc32
* crc32 not reversed: 0x04c11db7 (msb) */
static const uint32 crc32_table_m[256] = {
	0x00000000, 0x04c11db7, 0x09823b6e, 0x0d4326d9,
	0x130476dc, 0x17c56b6b, 0x1a864db2, 0x1e475005,
	0x2608edb8, 0x22c9f00f, 0x2f8ad6d6, 0x2b4bcb61,
	0x350c9b64, 0x31cd86d3, 0x3c8ea00a, 0x384fbdbd,
	0x4c11db70, 0x48d0c6c7, 0x4593e01e, 0x4152fda9,
	0x5f15adac, 0x5bd4b01b, 0x569796c2, 0x52568b75,
	0x6a1936c8, 0x6ed82b7f, 0x639b0da6, 0x675a1011,
	0x791d4014, 0x7ddc5da3, 0x709f7b7a, 0x745e66cd,
	0x9823b6e0, 0x9ce2ab57, 0x91a18d8e, 0x95609039,
	0x8b27c03c, 0x8fe6dd8b, 0x82a5fb52, 0x8664e6e5,
	0xbe2b5b58, 0xbaea46ef, 0xb7a96036, 0xb3687d81,
	0xad2f2d84, 0xa9ee3033, 0xa4ad16ea, 0xa06c0b5d,
	0xd4326d90, 0xd0f37027, 0xddb056fe, 0xd9714b49,
	0xc7361b4c, 0xc3f706fb, 0xceb42022, 0xca753d95,
	0xf23a8028, 0xf6fb9d9f, 0xfbb8bb46, 0xff79a6f1,
	0xe13ef6f4, 0xe5ffeb43, 0xe8bccd9a, 0xec7dd02d,
	0x34867077, 0x30476dc0, 0x3d044b19, 0x39c556ae,
	0x278206ab, 0x23431b1c, 0x2e003dc5, 0x2ac12072,
	0x128e9dcf, 0x164f8078, 0x1b0ca6a1, 0x1fcdbb16,
	0x018aeb13, 0x054bf6a4, 0x0808d07d, 0x0cc9cdca,
	0x7897ab07, 0x7c56b6b0, 0x71159069, 0x75d48dde,
	0x6b93dddb, 0x6f52c06c, 0x6211e6b5, 0x66d0fb02,
	0x5e9f46bf, 0x5a5e5b08, 0x571d7dd1, 0x53dc6066,
	0x4d9b3063, 0x495a2dd4, 0x44190b0d, 0x40d816ba,
	0xaca5c697, 0xa864db20, 0xa527fdf9, 0xa1e6e04e,
	0xbfa1b04b, 0xbb60adfc, 0xb6238b25, 0xb2e29692,
	0x8aad2b2f, 0x8e6c3698, 0x832f1041, 0x87ee0df6,
	0x99a95df3, 0x9d684044, 0x902b669d, 0x94ea7b2a,
	0xe0b41de7, 0xe4750050, 0xe9362689, 0xedf73b3e,
	0xf3b06b3b, 0xf771768c, 0xfa325055, 0xfef34de2,
	0xc6bcf05f, 0xc27dede8, 0xcf3ecb31, 0xcbffd686,
	0xd5b88683, 0xd1799b34, 0xdc3abded, 0xd8fba05a,
	0x690ce0ee, 0x6dcdfd59, 0x608edb80, 0x644fc637,
	0x7a089632, 0x7ec98b85, 0x738aad5c, 0x774bb0eb,
	0x4f040d56, 0x4bc510e1, 0x46863638, 0x42472b8f,
	0x5c007b8a, 0x58c1663d, 0x558240e4, 0x51435d53,
	0x251d3b9e, 0x21dc2629, 0x2c9f00f0, 0x285e1d47,
	0x36194d42, 0x32d850f5, 0x3f9b762c, 0x3b5a6b9b,
	0x0315d626, 0x07d4cb91, 0x0a97ed48, 0x0e56f0ff,
	0x1011a0fa, 0x14d0bd4d, 0x19939b94, 0x1d528623,
	0xf12f560e, 0xf5ee4bb9, 0xf8ad6d60, 0xfc6c70d7,
	0xe22b20d2, 0xe6ea3d65, 0xeba91bbc, 0xef68060b,
	0xd727bbb6, 0xd3e6a601, 0xdea580d8, 0xda649d6f,
	0xc423cd6a, 0xc0e2d0dd, 0xcda1f604, 0xc960ebb3,
	0xbd3e8d7e, 0xb9ff90c9, 0xb4bcb610, 0xb07daba7,
	0xae3afba2, 0xaafbe615, 0xa7b8c0cc, 0xa379dd7b,
	0x9b3660c6, 0x9ff77d71, 0x92b45ba8, 0x9675461f,
	0x8832161a, 0x8cf30bad, 0x81b02d74, 0x857130c3,
	0x5d8a9099, 0x594b8d2e, 0x5408abf7, 0x50c9b640,
	0x4e8ee645, 0x4a4ffbf2, 0x470cdd2b, 0x43cdc09c,
	0x7b827d21, 0x7f436096, 0x7200464f, 0x76c15bf8,
	0x68860bfd, 0x6c47164a, 0x61043093, 0x65c52d24,
	0x119b4be9, 0x155a565e, 0x18197087, 0x1cd86d30,
	0x029f3d35, 0x065e2082, 0x0b1d065b, 0x0fdc1bec,
	0x3793a651, 0x3352bbe6, 0x3e119d3f, 0x3ad08088,
	0x2497d08d, 0x2056cd3a, 0x2d15ebe3, 0x29d4f654,
	0xc5a92679, 0xc1683bce, 0xcc2b1d17, 0xc8ea00a0,
	0xd6ad50a5, 0xd26c4d12, 0xdf2f6bcb, 0xdbee767c,
	0xe3a1cbc1, 0xe760d676, 0xea23f0af, 0xeee2ed18,
	0xf0a5bd1d, 0xf464a0aa, 0xf9278673, 0xfde69bc4,
	0x89b8fd09, 0x8d79e0be, 0x803ac667, 0x84fbdbd0,
	0x9abc8bd5, 0x9e7d9662, 0x933eb0bb, 0x97ffad0c,
	0xafb010b1, 0xab710d06, 0xa6322bdf, 0xa2f33668,
	0xbcb4666d, 0xb8757bda, 0xb5365d03, 0xb1f740b4
	};

/* crc32 after reversed: 0xedb88320 (lsb) */
static const uint32 crc32_table_l[256] = {
	0x00000000, 0x77073096, 0xee0e612c, 0x990951ba,
	0x076dc419, 0x706af48f, 0xe963a535, 0x9e6495a3,
	0x0edb8832, 0x79dcb8a4, 0xe0d5e91e, 0x97d2d988,
	0x09b64c2b, 0x7eb17cbd, 0xe7b82d07, 0x90bf1d91,
	0x1db71064, 0x6ab020f2, 0xf3b97148, 0x84be41de,
	0x1adad47d, 0x6ddde4eb, 0xf4d4b551, 0x83d385c7,
	0x136c9856, 0x646ba8c0, 0xfd62f97a, 0x8a65c9ec,
	0x14015c4f, 0x63066cd9, 0xfa0f3d63, 0x8d080df5,
	0x3b6e20c8, 0x4c69105e, 0xd56041e4, 0xa2677172,
	0x3c03e4d1, 0x4b04d447, 0xd20d85fd, 0xa50ab56b,
	0x35b5a8fa, 0x42b2986c, 0xdbbbc9d6, 0xacbcf940,
	0x32d86ce3, 0x45df5c75, 0xdcd60dcf, 0xabd13d59,
	0x26d930ac, 0x51de003a, 0xc8d75180, 0xbfd06116,
	0x21b4f4b5, 0x56b3c423, 0xcfba9599, 0xb8bda50f,
	0x2802b89e, 0x5f058808, 0xc60cd9b2, 0xb10be924,
	0x2f6f7c87, 0x58684c11, 0xc1611dab, 0xb6662d3d,
	0x76dc4190, 0x01db7106, 0x98d220bc, 0xefd5102a,
	0x71b18589, 0x06b6b51f, 0x9fbfe4a5, 0xe8b8d433,
	0x7807c9a2, 0x0f00f934, 0x9609a88e, 0xe10e9818,
	0x7f6a0dbb, 0x086d3d2d, 0x91646c97, 0xe6635c01,
	0x6b6b51f4, 0x1c6c6162, 0x856530d8, 0xf262004e,
	0x6c0695ed, 0x1b01a57b, 0x8208f4c1, 0xf50fc457,
	0x65b0d9c6, 0x12b7e950, 0x8bbeb8ea, 0xfcb9887c,
	0x62dd1ddf, 0x15da2d49, 0x8cd37cf3, 0xfbd44c65,
	0x4db26158, 0x3ab551ce, 0xa3bc0074, 0xd4bb30e2,
	0x4adfa541, 0x3dd895d7, 0xa4d1c46d, 0xd3d6f4fb,
	0x4369e96a, 0x346ed9fc, 0xad678846, 0xda60b8d0,
	0x44042d73, 0x33031de5, 0xaa0a4c5f, 0xdd0d7cc9,
	0x5005713c, 0x270241aa, 0xbe0b1010, 0xc90c2086,
	0x5768b525, 0x206f85b3, 0xb966d409, 0xce61e49f,
	0x5edef90e, 0x29d9c998, 0xb0d09822, 0xc7d7a8b4,
	0x59b33d17, 0x2eb40d81, 0xb7bd5c3b, 0xc0ba6cad,
	0xedb88320, 0x9abfb3b6, 0x03b6e20c, 0x74b1d29a,
	0xead54739, 0x9dd277af, 0x04db2615, 0x73dc1683,
	0xe3630b12, 0x94643b84, 0x0d6d6a3e, 0x7a6a5aa8,
	0xe40ecf0b, 0x9309ff9d, 0x0a00ae27, 0x7d079eb1,
	0xf00f9344, 0x8708a3d2, 0x1e01f268, 0x6906c2fe,
	0xf762575d, 0x806567cb, 0x196c3671, 0x6e6b06e7,
	0xfed41b76, 0x89d32be0, 0x10da7a5a, 0x67dd4acc,
	0xf9b9df6f, 0x8ebeeff9, 0x17b7be43, 0x60b08ed5,
	0xd6d6a3e8, 0xa1d1937e, 0x38d8c2c4, 0x4fdff252,
	0xd1bb67f1, 0xa6bc5767, 0x3fb506dd, 0x48b2364b,
	0xd80d2bda, 0xaf0a1b4c, 0x36034af6, 0x41047a60,
	0xdf60efc3, 0xa867df55, 0x316e8eef, 0x4669be79,
	0xcb61b38c, 0xbc66831a, 0x256fd2a0, 0x5268e236,
	0xcc0c7795, 0xbb0b4703, 0x220216b9, 0x5505262f,
	0xc5ba3bbe, 0xb2bd0b28, 0x2bb45a92, 0x5cb36a04,
	0xc2d7ffa7, 0xb5d0cf31, 0x2cd99e8b, 0x5bdeae1d,
	0x9b64c2b0, 0xec63f226, 0x756aa39c, 0x026d930a,
	0x9c0906a9, 0xeb0e363f, 0x72076785, 0x05005713,
	0x95bf4a82, 0xe2b87a14, 0x7bb12bae, 0x0cb61b38,
	0x92d28e9b, 0xe5d5be0d, 0x7cdcefb7, 0x0bdbdf21,
	0x86d3d2d4, 0xf1d4e242, 0x68ddb3f8, 0x1fda836e,
	0x81be16cd, 0xf6b9265b, 0x6fb077e1, 0x18b74777,
	0x88085ae6, 0xff0f6a70, 0x66063bca, 0x11010b5c,
	0x8f659eff, 0xf862ae69, 0x616bffd3, 0x166ccf45,
	0xa00ae278, 0xd70dd2ee, 0x4e048354, 0x3903b3c2,
	0xa7672661, 0xd06016f7, 0x4969474d, 0x3e6e77db,
	0xaed16a4a, 0xd9d65adc, 0x40df0b66, 0x37d83bf0,
	0xa9bcae53, 0xdebb9ec5, 0x47b2cf7f, 0x30b5ffe9,
	0xbdbdf21c, 0xcabac28a, 0x53b39330, 0x24b4a3a6,
	0xbad03605, 0xcdd70693, 0x54de5729, 0x23d967bf,
	0xb3667a2e, 0xc4614ab8, 0x5d681b02, 0x2a6f2b94,
	0xb40bbe37, 0xc30c8ea1, 0x5a05df1b, 0x2d02ef8d
	};

/* crc32 not reversed: 0x1edc6f41 (msb) */
static const uint32 crc32_table_mc[256] = {
	0x00000000, 0x1edc6f41, 0x3db8de82, 0x2364b1c3,
	0x7b71bd04, 0x65add245, 0x46c96386, 0x58150cc7,
	0xf6e37a08, 0xe83f1549, 0xcb5ba48a, 0xd587cbcb,
	0x8d92c70c, 0x934ea84d, 0xb02a198e, 0xaef676cf,
	0xf31a9b51, 0xedc6f410, 0xcea245d3, 0xd07e2a92,
	0x886b2655, 0x96b74914, 0xb5d3f8d7, 0xab0f9796,
	0x05f9e159, 0x1b258e18, 0x38413fdb, 0x269d509a,
	0x7e885c5d, 0x6054331c, 0x433082df, 0x5deced9e,
	0xf8e959e3, 0xe63536a2, 0xc5518761, 0xdb8de820,
	0x8398e4e7, 0x9d448ba6, 0xbe203a65, 0xa0fc5524,
	0x0e0a23eb, 0x10d64caa, 0x33b2fd69, 0x2d6e9228,
	0x757b9eef, 0x6ba7f1ae, 0x48c3406d, 0x561f2f2c,
	0x0bf3c2b2, 0x152fadf3, 0x364b1c30, 0x28977371,
	0x70827fb6, 0x6e5e10f7, 0x4d3aa134, 0x53e6ce75,
	0xfd10b8ba, 0xe3ccd7fb, 0xc0a86638, 0xde740979,
	0x866105be, 0x98bd6aff, 0xbbd9db3c, 0xa505b47d,
	0xef0edc87, 0xf1d2b3c6, 0xd2b60205, 0xcc6a6d44,
	0x947f6183, 0x8aa30ec2, 0xa9c7bf01, 0xb71bd040,
	0x19eda68f, 0x0731c9ce, 0x2455780d, 0x3a89174c,
	0x629c1b8b, 0x7c4074ca, 0x5f24c509, 0x41f8aa48,
	0x1c1447d6, 0x02c82897, 0x21ac9954, 0x3f70f615,
	0x6765fad2, 0x79b99593, 0x5add2450, 0x44014b11,
	0xeaf73dde, 0xf42b529f, 0xd74fe35c, 0xc9938c1d,
	0x918680da, 0x8f5aef9b, 0xac3e5e58, 0xb2e23119,
	0x17e78564, 0x093bea25, 0x2a5f5be6, 0x348334a7,
	0x6c963860, 0x724a5721, 0x512ee6e2, 0x4ff289a3,
	0xe104ff6c, 0xffd8902d, 0xdcbc21ee, 0xc2604eaf,
	0x9a754268, 0x84a92d29, 0xa7cd9cea, 0xb911f3ab,
	0xe4fd1e35, 0xfa217174, 0xd945c0b7, 0xc799aff6,
	0x9f8ca331, 0x8150cc70, 0xa2347db3, 0xbce812f2,
	0x121e643d, 0x0cc20b7c, 0x2fa6babf, 0x317ad5fe,
	0x696fd939, 0x77b3b678, 0x54d707bb, 0x4a0b68fa,
	0xc0c1d64f, 0xde1db90e, 0xfd7908cd, 0xe3a5678c,
	0xbbb06b4b, 0xa56c040a, 0x8608b5c9, 0x98d4da88,
	0x3622ac47, 0x28fec306, 0x0b9a72c5, 0x15461d84,
	0x4d531143, 0x538f7e02, 0x70ebcfc1, 0x6e37a080,
	0x33db4d1e, 0x2d07225f, 0x0e63939c, 0x10bffcdd,
	0x48aaf01a, 0x56769f5b, 0x75122e98, 0x6bce41d9,
	0xc5383716, 0xdbe45857, 0xf880e994, 0xe65c86d5,
	0xbe498a12, 0xa095e553, 0x83f15490, 0x9d2d3bd1,
	0x38288fac, 0x26f4e0ed, 0x0590512e, 0x1b4c3e6f,
	0x435932a8, 0x5d855de9, 0x7ee1ec2a, 0x603d836b,
	0xcecbf5a4, 0xd0179ae5, 0xf3732b26, 0xedaf4467,
	0xb5ba48a0, 0xab6627e1, 0x88029622, 0x96def963,
	0xcb3214fd, 0xd5ee7bbc, 0xf68aca7f, 0xe856a53e,
	0xb043a9f9, 0xae9fc6b8, 0x8dfb777b, 0x9327183a,
	0x3dd16ef5, 0x230d01b4, 0x0069b077, 0x1eb5df36,
	0x46a0d3f1, 0x587cbcb0, 0x7b180d73, 0x65c46232,
	0x2fcf0ac8, 0x31136589, 0x1277d44a, 0x0cabbb0b,
	0x54beb7cc, 0x4a62d88d, 0x6906694e, 0x77da060f,
	0xd92c70c0, 0xc7f01f81, 0xe494ae42, 0xfa48c103,
	0xa25dcdc4, 0xbc81a285, 0x9fe51346, 0x81397c07,
	0xdcd59199, 0xc209fed8, 0xe16d4f1b, 0xffb1205a,
	0xa7a42c9d, 0xb97843dc, 0x9a1cf21f, 0x84c09d5e,
	0x2a36eb91, 0x34ea84d0, 0x178e3513, 0x09525a52,
	0x51475695, 0x4f9b39d4, 0x6cff8817, 0x7223e756,
	0xd726532b, 0xc9fa3c6a, 0xea9e8da9, 0xf442e2e8,
	0xac57ee2f, 0xb28b816e, 0x91ef30ad, 0x8f335fec,
	0x21c52923, 0x3f194662, 0x1c7df7a1, 0x02a198e0,
	0x5ab49427, 0x4468fb66, 0x670c4aa5, 0x79d025e4,
	0x243cc87a, 0x3ae0a73b, 0x198416f8, 0x075879b9,
	0x5f4d757e, 0x41911a3f, 0x62f5abfc, 0x7c29c4bd,
	0xd2dfb272, 0xcc03dd33, 0xef676cf0, 0xf1bb03b1,
	0xa9ae0f76, 0xb7726037, 0x9416d1f4, 0x8acabeb5
	};

/* crc32 after reversed: 0x82f63b78 (lsb) */
static const uint32 crc32_table_lc[256] = {
	0x00000000, 0xf26b8303, 0xe13b70f7, 0x1350f3f4,
	0xc79a971f, 0x35f1141c, 0x26a1e7e8, 0xd4ca64eb,
	0x8ad958cf, 0x78b2dbcc, 0x6be22838, 0x9989ab3b,
	0x4d43cfd0, 0xbf284cd3, 0xac78bf27, 0x5e133c24,
	0x105ec76f, 0xe235446c, 0xf165b798, 0x030e349b,
	0xd7c45070, 0x25afd373, 0x36ff2087, 0xc494a384,
	0x9a879fa0, 0x68ec1ca3, 0x7bbcef57, 0x89d76c54,
	0x5d1d08bf, 0xaf768bbc, 0xbc267848, 0x4e4dfb4b,
	0x20bd8ede, 0xd2d60ddd, 0xc186fe29, 0x33ed7d2a,
	0xe72719c1, 0x154c9ac2, 0x061c6936, 0xf477ea35,
	0xaa64d611, 0x580f5512, 0x4b5fa6e6, 0xb93425e5,
	0x6dfe410e, 0x9f95c20d, 0x8cc531f9, 0x7eaeb2fa,
	0x30e349b1, 0xc288cab2, 0xd1d83946, 0x23b3ba45,
	0xf779deae, 0x05125dad, 0x1642ae59, 0xe4292d5a,
	0xba3a117e, 0x4851927d, 0x5b016189, 0xa96ae28a,
	0x7da08661, 0x8fcb0562, 0x9c9bf696, 0x6ef07595,
	0x417b1dbc, 0xb3109ebf, 0xa0406d4b, 0x522bee48,
	0x86e18aa3, 0x748a09a0, 0x67dafa54, 0x95b17957,
	0xcba24573, 0x39c9c670, 0x2a993584, 0xd8f2b687,
	0x0c38d26c, 0xfe53516f, 0xed03a29b, 0x1f682198,
	0x5125dad3, 0xa34e59d0, 0xb01eaa24, 0x42752927,
	0x96bf4dcc, 0x64d4cecf, 0x77843d3b, 0x85efbe38,
	0xdbfc821c, 0x2997011f, 0x3ac7f2eb, 0xc8ac71e8,
	0x1c661503, 0xee0d9600, 0xfd5d65f4, 0x0f36e6f7,
	0x61c69362, 0x93ad1061, 0x80fde395, 0x72966096,
	0xa65c047d, 0x5437877e, 0x4767748a, 0xb50cf789,
	0xeb1fcbad, 0x197448ae, 0x0a24bb5a, 0xf84f3859,
	0x2c855cb2, 0xdeeedfb1, 0xcdbe2c45, 0x3fd5af46,
	0x7198540d, 0x83f3d70e, 0x90a324fa, 0x62c8a7f9,
	0xb602c312, 0x44694011, 0x5739b3e5, 0xa55230e6,
	0xfb410cc2, 0x092a8fc1, 0x1a7a7c35, 0xe811ff36,
	0x3cdb9bdd, 0xceb018de, 0xdde0eb2a, 0x2f8b6829,
	0x82f63b78, 0x709db87b, 0x63cd4b8f, 0x91a6c88c,
	0x456cac67, 0xb7072f64, 0xa457dc90, 0x563c5f93,
	0x082f63b7, 0xfa44e0b4, 0xe9141340, 0x1b7f9043,
	0xcfb5f4a8, 0x3dde77ab, 0x2e8e845f, 0xdce5075c,
	0x92a8fc17, 0x60c37f14, 0x73938ce0, 0x81f80fe3,
	0x55326b08, 0xa759e80b, 0xb4091bff, 0x466298fc,
	0x1871a4d8, 0xea1a27db, 0xf94ad42f, 0x0b21572c,
	0xdfeb33c7, 0x2d80b0c4, 0x3ed04330, 0xccbbc033,
	0xa24bb5a6, 0x502036a5, 0x4370c551, 0xb11b4652,
	0x65d122b9, 0x97baa1ba, 0x84ea524e, 0x7681d14d,
	0x2892ed69, 0xdaf96e6a, 0xc9a99d9e, 0x3bc21e9d,
	0xef087a76, 0x1d63f975, 0x0e330a81, 0xfc588982,
	0xb21572c9, 0x407ef1ca, 0x532e023e, 0xa145813d,
	0x758fe5d6, 0x87e466d5, 0x94b49521, 0x66df1622,
	0x38cc2a06, 0xcaa7a905, 0xd9f75af1, 0x2b9cd9f2,
	0xff56bd19, 0x0d3d3e1a, 0x1e6dcdee, 0xec064eed,
	0xc38d26c4, 0x31e6a5c7, 0x22b65633, 0xd0ddd530,
	0x0417b1db, 0xf67c32d8, 0xe52cc12c, 0x1747422f,
	0x49547e0b, 0xbb3ffd08, 0xa86f0efc, 0x5a048dff,
	0x8ecee914, 0x7ca56a17, 0x6ff599e3, 0x9d9e1ae0,
	0xd3d3e1ab, 0x21b862a8, 0x32e8915c, 0xc083125f,
	0x144976b4, 0xe622f5b7, 0xf5720643, 0x07198540,
	0x590ab964, 0xab613a67, 0xb831c993, 0x4a5a4a90,
	0x9e902e7b, 0x6cfbad78, 0x7fab5e8c, 0x8dc0dd8f,
	0xe330a81a, 0x115b2b19, 0x020bd8ed, 0xf0605bee,
	0x24aa3f05, 0xd6c1bc06, 0xc5914ff2, 0x37faccf1,
	0x69e9f0d5, 0x9b8273d6, 0x88d28022, 0x7ab90321,
	0xae7367ca, 0x5c18e4c9, 0x4f48173d, 0xbd23943e,
	0xf36e6f75, 0x0105ec76, 0x12551f82, 0xe03e9c81,
	0x34f4f86a, 0xc69f7b69, 0xd5cf889d, 0x27a40b9e,
	0x79b737ba, 0x8bdcb4b9, 0x988c474d, 0x6ae7c44e,
	0xbe2da0a5, 0x4c4623a6, 0x5f16d052, 0xad7d5351
	};

/* crc32 not reversed: 0x741b8cd7 (msb) */
static const uint32 crc32_table_mk[256] = {
	0x00000000, 0x741b8cd7, 0xe83719ae, 0x9c2c9579,
	0xa475bf8b, 0xd06e335c, 0x4c42a625, 0x38592af2,
	0x3cf0f3c1, 0x48eb7f16, 0xd4c7ea6f, 0xa0dc66b8,
	0x98854c4a, 0xec9ec09d, 0x70b255e4, 0x04a9d933,
	0x79e1e782, 0x0dfa6b55, 0x91d6fe2c, 0xe5cd72fb,
	0xdd945809, 0xa98fd4de, 0x35a341a7, 0x41b8cd70,
	0x45111443, 0x310a9894, 0xad260ded, 0xd93d813a,
	0xe164abc8, 0x957f271f, 0x0953b266, 0x7d483eb1,
	0xf3c3cf04, 0x87d843d3, 0x1bf4d6aa, 0x6fef5a7d,
	0x57b6708f, 0x23adfc58, 0xbf816921, 0xcb9ae5f6,
	0xcf333cc5, 0xbb28b012, 0x2704256b, 0x531fa9bc,
	0x6b46834e, 0x1f5d0f99, 0x83719ae0, 0xf76a1637,
	0x8a222886, 0xfe39a451, 0x62153128, 0x160ebdff,
	0x2e57970d, 0x5a4c1bda, 0xc6608ea3, 0xb27b0274,
	0xb6d2db47, 0xc2c95790, 0x5ee5c2e9, 0x2afe4e3e,
	0x12a764cc, 0x66bce81b, 0xfa907d62, 0x8e8bf1b5,
	0x939c12df, 0xe7879e08, 0x7bab0b71, 0x0fb087a6,
	0x37e9ad54, 0x43f22183, 0xdfdeb4fa, 0xabc5382d,
	0xaf6ce11e, 0xdb776dc9, 0x475bf8b0, 0x33407467,
	0x0b195e95, 0x7f02d242, 0xe32e473b, 0x9735cbec,
	0xea7df55d, 0x9e66798a, 0x024aecf3, 0x76516024,
	0x4e084ad6, 0x3a13c601, 0xa63f5378, 0xd224dfaf,
	0xd68d069c, 0xa2968a4b, 0x3eba1f32, 0x4aa193e5,
	0x72f8b917, 0x06e335c0, 0x9acfa0b9, 0xeed42c6e,
	0x605fdddb, 0x1444510c, 0x8868c475, 0xfc7348a2,
	0xc42a6250, 0xb031ee87, 0x2c1d7bfe, 0x5806f729,
	0x5caf2e1a, 0x28b4a2cd, 0xb49837b4, 0xc083bb63,
	0xf8da9191, 0x8cc11d46, 0x10ed883f, 0x64f604e8,
	0x19be3a59, 0x6da5b68e, 0xf18923f7, 0x8592af20,
	0xbdcb85d2, 0xc9d00905, 0x55fc9c7c, 0x21e710ab,
	0x254ec998, 0x5155454f, 0xcd79d036, 0xb9625ce1,
	0x813b7613, 0xf520fac4, 0x690c6fbd, 0x1d17e36a,
	0x5323a969, 0x273825be, 0xbb14b0c7, 0xcf0f3c10,
	0xf75616e2, 0x834d9a35, 0x1f610f4c, 0x6b7a839b,
	0x6fd35aa8, 0x1bc8d67f, 0x87e44306, 0xf3ffcfd1,
	0xcba6e523, 0xbfbd69f4, 0x2391fc8d, 0x578a705a,
	0x2ac24eeb, 0x5ed9c23c, 0xc2f55745, 0xb6eedb92,
	0x8eb7f160, 0xfaac7db7, 0x6680e8ce, 0x129b6419,
	0x1632bd2a, 0x622931fd, 0xfe05a484, 0x8a1e2853,
	0xb24702a1, 0xc65c8e76, 0x5a701b0f, 0x2e6b97d8,
	0xa0e0666d, 0xd4fbeaba, 0x48d77fc3, 0x3cccf314,
	0x0495d9e6, 0x708e5531, 0xeca2c048, 0x98b94c9f,
	0x9c1095ac, 0xe80b197b, 0x74278c02, 0x003c00d5,
	0x38652a27, 0x4c7ea6f0, 0xd0523389, 0xa449bf5e,
	0xd90181ef, 0xad1a0d38, 0x31369841, 0x452d1496,
	0x7d743e64, 0x096fb2b3, 0x954327ca, 0xe158ab1d,
	0xe5f1722e, 0x91eafef9, 0x0dc66b80, 0x79dde757,
	0x4184cda5, 0x359f4172, 0xa9b3d40b, 0xdda858dc,
	0xc0bfbbb6, 0xb4a43761, 0x2888a218, 0x5c932ecf,
	0x64ca043d, 0x10d188ea, 0x8cfd1d93, 0xf8e69144,
	0xfc4f4877, 0x8854c4a0, 0x147851d9, 0x6063dd0e,
	0x583af7fc, 0x2c217b2b, 0xb00dee52, 0xc4166285,
	0xb95e5c34, 0xcd45d0e3, 0x5169459a, 0x2572c94d,
	0x1d2be3bf, 0x69306f68, 0xf51cfa11, 0x810776c6,
	0x85aeaff5, 0xf1b52322, 0x6d99b65b, 0x19823a8c,
	0x21db107e, 0x55c09ca9, 0xc9ec09d0, 0xbdf78507,
	0x337c74b2, 0x4767f865, 0xdb4b6d1c, 0xaf50e1cb,
	0x9709cb39, 0xe31247ee, 0x7f3ed297, 0x0b255e40,
	0x0f8c8773, 0x7b970ba4, 0xe7bb9edd, 0x93a0120a,
	0xabf938f8, 0xdfe2b42f, 0x43ce2156, 0x37d5ad81,
	0x4a9d9330, 0x3e861fe7, 0xa2aa8a9e, 0xd6b10649,
	0xeee82cbb, 0x9af3a06c, 0x06df3515, 0x72c4b9c2,
	0x766d60f1, 0x0276ec26, 0x9e5a795f, 0xea41f588,
	0xd218df7a, 0xa60353ad, 0x3a2fc6d4, 0x4e344a03
	};

/* crc32 after reversed: 0xeb31d82e (lsb) */
static const uint32 crc32_table_lk[256] = {
	0x00000000, 0x9695c4ca, 0xfb4839c9, 0x6dddfd03,
	0x20f3c3cf, 0xb6660705, 0xdbbbfa06, 0x4d2e3ecc,
	0x41e7879e, 0xd7724354, 0xbaafbe57, 0x2c3a7a9d,
	0x61144451, 0xf781809b, 0x9a5c7d98, 0x0cc9b952,
	0x83cf0f3c, 0x155acbf6, 0x788736f5, 0xee12f23f,
	0xa33cccf3, 0x35a90839, 0x5874f53a, 0xcee131f0,
	0xc22888a2, 0x54bd4c68, 0x3960b16b, 0xaff575a1,
	0xe2db4b6d, 0x744e8fa7, 0x199372a4, 0x8f06b66e,
	0xd1fdae25, 0x47686aef, 0x2ab597ec, 0xbc205326,
	0xf10e6dea, 0x679ba920, 0x0a465423, 0x9cd390e9,
	0x901a29bb, 0x068fed71, 0x6b521072, 0xfdc7d4b8,
	0xb0e9ea74, 0x267c2ebe, 0x4ba1d3bd, 0xdd341777,
	0x5232a119, 0xc4a765d3, 0xa97a98d0, 0x3fef5c1a,
	0x72c162d6, 0xe454a61c, 0x89895b1f, 0x1f1c9fd5,
	0x13d52687, 0x8540e24d, 0xe89d1f4e, 0x7e08db84,
	0x3326e548, 0xa5b32182, 0xc86edc81, 0x5efb184b,
	0x7598ec17, 0xe30d28dd, 0x8ed0d5de, 0x18451114,
	0x556b2fd8, 0xc3feeb12, 0xae231611, 0x38b6d2db,
	0x347f6b89, 0xa2eaaf43, 0xcf375240, 0x59a2968a,
	0x148ca846, 0x82196c8c, 0xefc4918f, 0x79515545,
	0xf657e32b, 0x60c227e1, 0x0d1fdae2, 0x9b8a1e28,
	0xd6a420e4, 0x4031e42e, 0x2dec192d, 0xbb79dde7,
	0xb7b064b5, 0x2125a07f, 0x4cf85d7c, 0xda6d99b6,
	0x9743a77a, 0x01d663b0, 0x6c0b9eb3, 0xfa9e5a79,
	0xa4654232, 0x32f086f8, 0x5f2d7bfb, 0xc9b8bf31,
	0x849681fd, 0x12034537, 0x7fdeb834, 0xe94b7cfe,
	0xe582c5ac, 0x73170166, 0x1ecafc65, 0x885f38af,
	0xc5710663, 0x53e4c2a9, 0x3e393faa, 0xa8acfb60,
	0x27aa4d0e, 0xb13f89c4, 0xdce274c7, 0x4a77b00d,
	0x07598ec1, 0x91cc4a0b, 0xfc11b708, 0x6a8473c2,
	0x664dca90, 0xf0d80e5a, 0x9d05f359, 0x0b903793,
	0x46be095f, 0xd02bcd95, 0xbdf63096, 0x2b63f45c,
	0xeb31d82e, 0x7da41ce4, 0x1079e1e7, 0x86ec252d,
	0xcbc21be1, 0x5d57df2b, 0x308a2228, 0xa61fe6e2,
	0xaad65fb0, 0x3c439b7a, 0x519e6679, 0xc70ba2b3,
	0x8a259c7f, 0x1cb058b5, 0x716da5b6, 0xe7f8617c,
	0x68fed712, 0xfe6b13d8, 0x93b6eedb, 0x05232a11,
	0x480d14dd, 0xde98d017, 0xb3452d14, 0x25d0e9de,
	0x2919508c, 0xbf8c9446, 0xd2516945, 0x44c4ad8f,
	0x09ea9343, 0x9f7f5789, 0xf2a2aa8a, 0x64376e40,
	0x3acc760b, 0xac59b2c1, 0xc1844fc2, 0x57118b08,
	0x1a3fb5c4, 0x8caa710e, 0xe1778c0d, 0x77e248c7,
	0x7b2bf195, 0xedbe355f, 0x8063c85c, 0x16f60c96,
	0x5bd8325a, 0xcd4df690, 0xa0900b93, 0x3605cf59,
	0xb9037937, 0x2f96bdfd, 0x424b40fe, 0xd4de8434,
	0x99f0baf8, 0x0f657e32, 0x62b88331, 0xf42d47fb,
	0xf8e4fea9, 0x6e713a63, 0x03acc760, 0x953903aa,
	0xd8173d66, 0x4e82f9ac, 0x235f04af, 0xb5cac065,
	0x9ea93439, 0x083cf0f3, 0x65e10df0, 0xf374c93a,
	0xbe5af7f6, 0x28cf333c, 0x4512ce3f, 0xd3870af5,
	0xdf4eb3a7, 0x49db776d, 0x24068a6e, 0xb2934ea4,
	0xffbd7068, 0x6928b4a2, 0x04f549a1, 0x92608d6b,
	0x1d663b05, 0x8bf3ffcf, 0xe62e02cc, 0x70bbc606,
	0x3d95f8ca, 0xab003c00, 0xc6ddc103, 0x504805c9,
	0x5c81bc9b, 0xca147851, 0xa7c98552, 0x315c4198,
	0x7c727f54, 0xeae7bb9e, 0x873a469d, 0x11af8257,
	0x4f549a1c, 0xd9c15ed6, 0xb41ca3d5, 0x2289671f,
	0x6fa759d3, 0xf9329d19, 0x94ef601a, 0x027aa4d0,
	0x0eb31d82, 0x9826d948, 0xf5fb244b, 0x636ee081,
	0x2e40de4d, 0xb8d51a87, 0xd508e784, 0x439d234e,
	0xcc9b9520, 0x5a0e51ea, 0x37d3ace9, 0xa1466823,
	0xec6856ef, 0x7afd9225, 0x17206f26, 0x81b5abec,
	0x8d7c12be, 0x1be9d674, 0x76342b77, 0xe0a1efbd,
	0xad8fd171, 0x3b1a15bb, 0x56c7e8b8, 0xc0522c72
	};
/* end */

/* @func: crc32_table - get crc32 table
* @param3: int32          # crc32 type
* @return: const uint32 * # crc32 table
*/
const uint32 *FSYMBOL(crc32_table)(int32 type) {
	switch (type) {
		case CRC32_DEFAULT_MSB_TYPE:
			return crc32_table_m;
		case CRC32_DEFAULT_LSB_TYPE:
			return crc32_table_l;
		case CRC32_CASTAGNOLI_MSB_TYPE:
			return crc32_table_mc;
		case CRC32_CASTAGNOLI_LSB_TYPE:
			return crc32_table_lc;
		case CRC32_KOOPMAN_MSB_TYPE:
			return crc32_table_mk;
		case CRC32_KOOPMAN_LSB_TYPE:
			return crc32_table_lk;
		case CRC32_CKSUM_MSB_TYPE:
			return crc32_table_m;
		default:
			return NULL;
	}

	return NULL;
} /* end */

/* @func: crc32_msb - crc32 msb cyclic redundancy
* @param1: const uint32 * # crc32 table
* @param2: uint32         # init value
* @param3: const uint8 *  # input buffer
* @param3: uint32         # input length
* @return: uint32         # crc32 value
*/
uint32 FSYMBOL(crc32_msb)(const uint32 *t, uint32 c, const uint8 *s,
		uint32 len) {
	uint8 k = 0;
	for (uint32 i = 0; i < len; i++) {
		k = s[i] ^ (c >> 24);
		c = t[k] ^ (c << 8);
	}

	return c;
} /* end */

/* @func: crc32_lsb - crc32 lsb cyclic redundancy
* @param1: const uint32 * # crc32 table
* @param2: uint32         # init value
* @param3: const uint8 *  # input buffer
* @param3: uint32         # input length
* @return: uint32         # crc32 value
*/
uint32 FSYMBOL(crc32_lsb)(const uint32 *t, uint32 c, const uint8 *s,
		uint32 len) {
	uint8 k = 0;
	for (uint32 i = 0; i < len; i++) {
		k = s[i] ^ (c & 0xff);
		c = t[k] ^ (c >> 8);
	}

	return c;
} /* end */

/* @func: crc32_cksum_size_msb - add cksum size cyclic redundancy
* @param1: const uint32 * # crc32 table
* @param2: uint32         # init value
* @param3: uint32         # length
* @return: uint32         # crc32 value
*/
uint32 FSYMBOL(crc32_cksum_size_msb)(const uint32 *t, uint32 c,
		uint32 len) {
	uint8 k = 0;
	for (uint32 i = len; i; i >>= 8) {
		k = (i ^ (c >> 24)) & 0xff;
		c = t[k] ^ (c << 8);
	}

	return ~c;
} /* end */

/* @func: crc32 - crc32 cyclic redundancy check
* @param1: const uint8 * # input buffer
* @param2: uint32        # input length
* @param3: int32         # crc32 type
* @return: uint32        # crc32 value
*/
uint32 FSYMBOL(crc32)(const uint8 *s, uint32 len, int32 type) {
	uint32 b = 0xffffffff, e = 0xffffffff, c = 0;

	switch (type) {
		case CRC32_DEFAULT_MSB_TYPE:
			c = FSYMBOL(crc32_msb)(crc32_table_m, b, s, len);
			return c ^ e;
		case CRC32_DEFAULT_LSB_TYPE:
			c = FSYMBOL(crc32_lsb)(crc32_table_l, b, s, len);
			return c ^ e;
		case CRC32_CASTAGNOLI_MSB_TYPE:
			c = FSYMBOL(crc32_msb)(crc32_table_mc, b, s, len);
			return c ^ e;
		case CRC32_CASTAGNOLI_LSB_TYPE:
			c = FSYMBOL(crc32_lsb)(crc32_table_lc, b, s, len);
			return c ^ e;
		case CRC32_KOOPMAN_MSB_TYPE:
			c = FSYMBOL(crc32_msb)(crc32_table_mk, b, s, len);
			return c ^ e;
		case CRC32_KOOPMAN_LSB_TYPE:
			c = FSYMBOL(crc32_lsb)(crc32_table_lk, b, s, len);
			return c ^ e;
		case CRC32_CKSUM_MSB_TYPE:
			c = FSYMBOL(crc32_msb)(crc32_table_m, 0, s, len);
			return FSYMBOL(crc32_cksum_size_msb)(crc32_table_m,
				c, len);
		default:
			return 0;
	}

	return 0;
} /* end */
